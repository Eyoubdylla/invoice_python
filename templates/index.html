{% extends "base.html" %}
{%block content%}
{% load static %}
<br><br>
<div class="row">
    <a href="{% url 'add-invoice' %}" class="btn col-md-4 btn-primary">
        Register a new invoice <span class="badge text-bg-secondary"></span>
    </a>
    <a href="#" class="col-md-4">
        <span class="badge text-bg-secondaey"></span>
    </a>
    <a href= "{% url 'add-customer' %}" class="btn col-md-4 btn-primary">
        register a new customer <span class="badge text-bd-secondary"></span>
    </a>
</div>
<br><br>

<div class="form-group">
    <input id="search" class="form-control" type='text' placeholder="Search ...">
</div>

<div>
    <table class="table table-dark table-striped-columns">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">CUSTOMER NAME</th>
                <th scope="col">DATE</th>
                <th scope="col">TOTAL</th>
                <th scope="col">PAID</th>
                <th scope="col">TYPE OF INVOICE</th>
                <th scope="col">ACTION</th>
            </tr>
        </thead>
        <tbody id="myTable">
            <!--  injecter les donner dans le table -->
            {% if invoices %}
            {% for facture in invoices %}
            <tr>
                <th scope="row">{{ facture.pk }}</th>
                <td >{{facture.customer.name}}</td>
                <td >{{facture.invoice_date_time}}</td>
                <td >{{facture.total}}</td>
                <td >
                    {% if facture.paid %}
                    <img src="{% static 'images/icon-yes.svg' %}" alt="True">
                    (% else %)
                    <img src="{% static 'images/icon-no.svg' %}" alt="False">
                    {% endif %}
                </td>
                <th >{{facture.get_invoice_type_display}}</td>
                <td >
                    <a href="" title="Detail" class="badge text-white bg-success">View</a>

                    <button id="btn-invoice-sup" type="button" data.toggle="modal" data-target="#supprimer"
                        class="badge text-white bg-danger" title="supprimer" data.id="{{facture.pk}}"
                        data-customer="{{facture.customer.name}}">Delete
                    </button>

                    <button id="btn-invoice-sup" type="button" data.toggle="modal" data-target="#modifier"
                        class="badge text-white bg-danger" title="supprimer" data.customer="{{facture.customer.name}}"
                       class="badge text-dark bg-warning">Modifier
                    </button>
                </td>
            </tr>
            {% endfor %}
            {% if invoices.has_other_pages%}
            <div class="btn-group" role="group" aria-label="Item paginatio">
                {% if invoices.has_previous %}
                <a href="?page={{ invoices.has_previous_page_number}}" class="btn btn-outline-primary">&laquo;</a>
                {% endif%}
                {% for page_number in invoices.paginator.page_range %}
                    {% if invoices.number == page_number %}
                        <button class="btn btn-outline-primary active">
                            <span> {{page_number}}<span class="sr-only"> (current)</span></span>
                        </button>  
                    {% else %} 
                        <a href ="?page={{page_number}}" class="btn btn-outline-primary">
                            {{ page_number }}
                        </a>          
                    {% endif %}
                {% endfor %}
                {% if invoices.has_next %}
                <a href="?page={{ invoices.has_next_page_number}}" class="btn btn-outline-primary">&laquo;</a>
                {% endif%}
            </div>
            {%endif%}
            {% else %}
            <p class="text-center text-white">N o invoice found.</p>
            {% endif %}
        </tbody>
    </table>
</div>
<!------------- modal modifier --------------------------------------->
<div class="modal fade" id="modifier" tabindex="-1" role="dialog" aria-labelledby="exempleModallabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-dark text-center" id="examplemodallabel">Modification</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="closd">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="post">
                {% csrf_token %}
                <div class="modal-body">
                    <input name="id_modifed" type="hidden" id="id_modified">
                    <label id='label_id' class="text-dark checkbox-inline" ><strong id="strong_id">this bill has been paid ?</strong></label>

                    <input  type="radio" id="html" value="True">
                    <label  class="text-white bg-primary" for="html">Yes</label>

                    <input  type="radio" id="css" name="modifer" value="False">
                    <label  class="text-white bg-danger" for="css">No</label>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type=" submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!------------ end modal ------------------------------>
<!-- Modal suppression -->
 <div class="mdel fade" id="supprimer" tabindex="-1" role="dialog" aria-labelledby="sexampleModallabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div modal-header>
                <h5 class="modal-title text-dark" id="sexampleModallabel">Delete Invoice</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form method="post">
                    {% csrf_token %}
                        <input name="id_supprimer" type="hidden" id="id_supprimer">
                        <label id='label_id_s' class="text-dark checkbox-inline" ><strong id="strong_id_s">are you sure you want to delete the invoice ?</strong></label>

                        <input  type="radio" id="html" value="True">
                        <label  class="text-white bg-primary" for="html">Yes</label>

                        <input  type="radio" id="css" name="modifer" value="False">
                        <label  class="text-white bg-danger" for="css">No</label>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type=" submit" class="btn btn-primary">Save</button>
                </form>
            </div>
        </div>

    </div>

 </div>
 <script>
    $(document).ready(function(){
        $("#search").on("keyup", function(){
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function(){
                $(this).toggle($(this).text().toLocaleLowerCase().indexOf(value)>-1)
            });
        });
    });
 </script>
{% endblock content%}
